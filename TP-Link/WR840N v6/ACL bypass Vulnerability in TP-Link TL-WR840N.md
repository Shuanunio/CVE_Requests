#  ACL bypass Vulnerability in TP-Link WR840N v6

## 0x01 Vulnerability description

A  vulnerability in the TP-Link WR840N v6 router permits unauthorized individuals to bypass the authentication of some interfaces under the /cgi directory.When adding Referer: http://tplinkwifi.net to the the request, it will be recognized as passing the authentication.

```
Referer: http://tplinkwifi.net
```

## 0x02 Affected version

``` 
TP-Link WR840N v6
(Firmware version 0.9.1 4.16  and earlier)
```

## 0x03 PoC verification

When sending request packets directly, a 403 response is returned.

![image-20241210182850639](D:\edu\master\repo\CVE_Requests\TP-Link\WR840N v6\assets\image-20241210182850639.png)

However, by appending Referer: http://tplinkwifi.net in the header, you will receive a response packet with a status code of 200, which includes information that would normally require authorization to view.

![image-20241210182946957](D:\edu\master\repo\CVE_Requests\TP-Link\WR840N v6\assets\image-20241210182946957.png)

## 0x04 Acknowledgement

Shuanunio

## 0X05 CVE ID

CVE-2024-57050